<!doctype html>
<html>

<head>
    <title>testing</title>

    <script src="./src/jsTPS.js"></script>
    <script src="./src/jsTPS_Transaction.js"></script>
    <script src="./test/demo/AddToNum_Transaction.js"></script>
    <script src="./test/demo/Num.js"></script>

    <script>
        window.onload = function () {
        };
    </script>
    <script>
        var tps = new jsTPS();
        var num = new Num();
        var selection = null;
        var amountToAdd = null;
        var rowIndex = 0;
        function setSelection() {
            selection = document.getElementById('selection_textfield').value;
        }
        function updateStack() {
            selection = document.getElementById('selection_textfield').value;
            document.getElementById('selection_textfield').value = "";
            if (selection.startsWith("1")) {
                document.getElementById('add_prompt').style.display = 'block';
            }
            else if (selection.startsWith("2")) {
                tps.undoTransaction();
                addNewRow();
            }
            else if (selection.startsWith("3")) {
                tps.doTransaction();
                addNewRow();
            }
            else if (selection.startsWith("4")) {
                tps.clearAllTransactions();
                addNewRow();
            }
            else if (selection.startsWith("5")) {
                tps.clearAllTransactions();
                num.setNum(0);
                addNewRow();
            }
            else if (selection.startsWith("Q")) {
                document.getElementById("quit").style.display = 'block';
            }
        }
        function setAmount() { 
            amountToAdd = parseInt(document.getElementById('add_textfield').value);
        }
        function addAmount() {
            var transaction = new AddToNum_Transaction(num, amountToAdd);
            tps.addTransaction(transaction);
            document.getElementById('add_textfield').value = null;
            document.getElementById('add_prompt').style.display = 'none';
            addNewRow();
            document.getElementById('num').innerHTML = "Num is " + num.getNum();
        }
        function addNewRow() {
            var stackTable = document.getElementById('stack_table');
            rowIndex++;
            var row = stackTable.insertRow(rowIndex);
            var totalTransactions = row.insertCell(0); 
            var currentIndex = row.insertCell(1);
            var currentTransaction = row.insertCell(2);
            totalTransactions.innerHTML += tps.getManyTransactions();
            currentIndex.innerHTML += tps.getCurrentIndex();
            currentTransaction.innerHTML += tps.getCurrentTransaction();
            document.getElementById('num').innerHTML = "Num is " + num.getNum();
        }
    </script>

    <style>
        table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
        }   
    </style>

</head>

<body>
    <div id='jsTPS_tester_container' style='height: 200px; overflow: hidden; position: relative; border: 2px solid black; margin-bottom: 2%; padding: 2%'>
        <div id='selection_prompt' style='width:30%; position:absolute; left:30px; word-wrap:break-word;'>
            ENTER A SELECTION: </span>
            <input id='selection_textfield' type="text" size="4" defaultValue="" onchange="setSelection(this.value)"/>
            <button type="button" onclick="updateStack()">Enter</button>
            <div>1) Add a Transaction</div>
            <div id='add_prompt' style='display:none;'><i>&nbsp;&nbsp;&nbsp;&nbsp;Enter an amount to add: </i>
                <input id='add_textfield' type="text" size="13" defaultValue="" onchange="setAmount(this.value)"/>
                <button id='amount_button' type="button" onclick="addAmount()">Enter</button>
            </div>
            <div>
                2) Undo a Transaction</br>
                3) Redo a Transaction</br>
                4) Clear All Transactions</br>
                5) Reset Num and Transactions</br>
                Q) Quit
            </div>
            <div id='num' style="font-size: 20px; font-weight: bold">Num is 0</div>
            <div id="quit" style="display: none; font-size: 30px; color: blue">GOODBYE</div>
        </div>
        <div id='stack' style='width:70%; position:absolute; right:0;'>CURRENT jsTPS:
            <table id="stack_table" style="width:99%">
                <tr>
                    <th style='width:5%'>Total</th>
                    <th style='width:5%'>Index</th> 
                    <th style='width:89%'>Current Transaction</th>
                </tr>
            </table>
            <div id='stack_element'></div>
        </div>
    </div>
    <div id='jsTPS_unit_test_container' style='border: 2px solid black; padding: 2%'>
        
    </div>
</body>

</html>